<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Bayesian kernel machine regression (BKMR) is becoming a popular approach for studying the joint effect of environmental mixtures on health outcomes allowing for variable selection, which is particularly useful when continuous exposures display moderate correlations. An R package, bkmr, has been developed to implement this method. BKMR-causal mediation analysis (BKMR-CMA) has been proposed to estimate direct and indirect effects of mixtures through a hypothesized mediator.">
<title>Causal Inference with Bayesian kernel machine regression  • causalbkmr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Causal Inference with Bayesian kernel machine regression ">
<meta property="og:description" content="Bayesian kernel machine regression (BKMR) is becoming a popular approach for studying the joint effect of environmental mixtures on health outcomes allowing for variable selection, which is particularly useful when continuous exposures display moderate correlations. An R package, bkmr, has been developed to implement this method. BKMR-causal mediation analysis (BKMR-CMA) has been proposed to estimate direct and indirect effects of mixtures through a hypothesized mediator.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">causalbkmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-bkmr-cma">BKMR-CMA</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-bkmr-cma">
    <a class="dropdown-item" href="articles/BKMRCMA_method_overview.html">Overview of Methodology</a>
    <a class="dropdown-item" href="articles/BKMRCMA_QuickStart.html">Quick Start Example - continuous M and continuous Y</a>
    <a class="dropdown-item" href="articles/bkmrcma_example_scenario2.html">Example 2 - binary M and binary Y</a>
    <a class="dropdown-item" href="articles/bkmrcma_example_scenario3.html">Example 3 - binary M and continuous Y</a>
    <a class="dropdown-item" href="articles/bkmrcma_example_scenario4.html">Example 4 - continuous M and binary Y</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-mi-bkmr">MI BKMR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-mi-bkmr">
    <a class="dropdown-item" href="articles/BKMRMI_method_overview.html">Overview of Methodology</a>
    <a class="dropdown-item" href="articles/MI_BKMR.html">Quick Start</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-g-bkmr">g-BKMR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-g-bkmr">
    <a class="dropdown-item" href="articles/gBKMR_method_overview.html">Overview of Methodology</a>
    <h6 class="dropdown-header" data-toc-skip>Quick Start</h6>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zc2326/causalbkmr">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="causalbkmr-a-suite-of-functions-for-causal-bayesian-kernel-machine-regression-causal-bkmr">causalbkmr: a suite of functions for causal Bayesian Kernel Machine Regression (causal-BKMR)<a class="anchor" aria-label="anchor" href="#causalbkmr-a-suite-of-functions-for-causal-bayesian-kernel-machine-regression-causal-bkmr"></a>
</h1></div>
<!-- badges: start -->
<div class="section level2">
<h2 id="about-the-package">About the Package<a class="anchor" aria-label="anchor" href="#about-the-package"></a>
</h2>
<p>The R package <code>causalbkmr</code> consists of three parts: <code>BKMR-CMA</code> for Bayesian Kernel Machine Regression-Causal Mediation Analysis, <code>MI-BKMR</code> for Multiple Imputation BKMR, and <code>g-BKMR</code> for Bayesian Kernel Machine Regression for time-varying exposures and time-varying confounders.</p>
<p>We welcome your feedback and questions (email <a href="mailto:zc2326@columbia.edu" class="email">zc2326@columbia.edu</a>)!</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of <code>causalbkmr</code> via:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"zc2326/causalbkmr"</span><span class="op">)</span></span></code></pre></div>
<p>Load <code>causalbkmr</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zc2326/causalbkmr" class="external-link">causalbkmr</a></span><span class="op">)</span> </span></code></pre></div>
<div class="section level3">
<h3 id="bkmr-cma">BKMR-CMA<a class="anchor" aria-label="anchor" href="#bkmr-cma"></a>
</h3>
<p>A command that implements the BKMR-CMA method, wich allows the estimation of direct and indirect health effects of multiple environmental exposures through a single mediator.</p>
<p>We use BKMR for the mediator and outcome regression models since BKMR allows for all possible nonlinearities and interactions among the elements included in the kernel with the specified outcome, without a prior specification, and credible intervals a BKMR fit inherently control for multiple testing due to the Bayesian nature of the model and the prior specification.</p>
<p>We predict counterfactuals using the posterior predictive distributions of the mediator and the outcome and present an algorithm for estimation of mediation effects. We also conduct a simulation study to compare how our approach performs relative to current mediation methods that assume a restrictive linear relationship between the exposure, mediator, and outcome.</p>
<p>Cite the paper: <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sim.9255?casa_token=lf0hlEtqtjgAAAAA%3AyPLEllmuJGIeEN9ZMIr7kT33RjXQmjiLbUq4JjqfI5dxlSvkdeVjzkEiOqG9Rbh70Frxe3ONzA2aql8" class="external-link">Bayesian kernel machine regression-causal mediation analysis</a></p>
<p>See the <a href="https://zc2326.github.io/causalbkmr/articles/BKMRCMA_QuickStart.html">Quick Start guide</a> for <code>BKMR-CMA</code>. See the package <a href="https://zc2326.github.io/causalbkmr/articles/BKMRCMA_method_overview.html">website</a> for an overview of statistical modeling approaches.</p>
</div>
<div class="section level3">
<h3 id="bkmr-mi">BKMR-MI<a class="anchor" aria-label="anchor" href="#bkmr-mi"></a>
</h3>
<p>A command that is used for valid estimation of environmental mixture effects and evaluation of uncertainty in the presence of missing data, which are imputed using multiple imputation techniques. The commands combine information from multiple Bayesian kernel machine regression (BKMR) models fit using the bkmr R package (Bobb et al. 2015, Valeri et al. 2017, Bobb et al. 2018, Anglen Bauer et al. 2019). The commands also produce effective visualizations of the estimated causal effects and dose-response relationships. The package contains functions to be used with BKMR MI fits to create a data frame for plotting with <code>ggplot</code>.</p>
<p>The data <code>BKMRfits10</code> is simulated data with 10 BKMRfits, each is a BKMR fit using multiple imputed data with size <em>n</em> = 500.</p>
<p>See the <a href="https://zc2326.github.io/causalbkmr/articles/MI_BKMR.html">Quick Start guide</a> for <code>BKMR-CMA</code>. See the package <a href="https://zc2326.github.io/causalbkmr/articles/BKMRMI_method_overview.html">website</a> for an overview of statistical modeling approaches.</p>
</div>
<div class="section level3">
<h3 id="g-bkmr">g-BKMR<a class="anchor" aria-label="anchor" href="#g-bkmr"></a>
</h3>
<p>Exposure to environmental chemicals has been shown to rewire development affecting later health status. Quantifying the joint effect of environmental mixtures over time is crucial to determine intervention timing. However, causal interpretation of longitudinal environmental mixture studies encounters challenges. There is no statistical approach that allows simultaneously for time-varying confounding, flexible modeling, and variable selection when examining the effect of multiple, correlated, and time-varying exposures. To address these gaps, we develop a causal inference method, g-BKMR, which enables us to estimate nonlinear, non-additive effects of time-varying exposures and time-varying confounders, while also allowing for variable selection.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/zc2326/causalbkmr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/zc2326/causalbkmr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing causalbkmr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zilan Chai <br><small class="roles"> Author, maintainer </small>  </li>
<li>Katrina Devick <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://www.lindavaleri.com/" class="external-link">Linda Valeri</a> <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.com/zc2326/causalbkmr" class="external-link"><img src="https://travis-ci.com/zc2326/causalbkmr.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zilan Chai, Katrina Devick, <a href="https://www.lindavaleri.com/" class="external-link">Linda Valeri</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
