<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="causalbkmr">
<title>gBKMR_method_overview • causalbkmr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="gBKMR_method_overview">
<meta property="og:description" content="causalbkmr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-default navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">causalbkmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-bkmr-cma">BKMR-CMA</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-bkmr-cma">
    <a class="dropdown-item" href="../articles/BKMRCMA_method_overview.html">Overview of Methodology</a>
    <a class="dropdown-item" href="../articles/BKMRCMA_QuickStart.html">Quick Start Example - continuous M and continuous Y</a>
    <a class="dropdown-item" href="../articles/bkmrcma_example_scenario2.html">Example 2 - binary M and binary Y</a>
    <a class="dropdown-item" href="../articles/bkmrcma_example_scenario3.html">Example 3 - binary M and continuous Y</a>
    <a class="dropdown-item" href="../articles/bkmrcma_example_scenario4.html">Example 4 - continuous M and binary Y</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-mi-bkmr">MI BKMR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-mi-bkmr">
    <a class="dropdown-item" href="../articles/BKMRMI_method_overview.html">Overview of Methodology</a>
    <a class="dropdown-item" href="../articles/MI_BKMR.html">Quick Start</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-g-bkmr">g-BKMR</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-g-bkmr">
    <a class="dropdown-item" href="../articles/gBKMR_method_overview.html">Overview of Methodology</a>
    <h6 class="dropdown-header" data-toc-skip>Quick Start</h6>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zc2326/causalbkmr">
    <span class="fa fa-github fa-lg"></span>
     
    Github
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>gBKMR_method_overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zc2326/causalbkmr/blob/HEAD/vignettes/gBKMR_method_overview.Rmd" class="external-link"><code>vignettes/gBKMR_method_overview.Rmd</code></a></small>
      <div class="d-none name"><code>gBKMR_method_overview.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/zc2326/causalbkmr" class="external-link">causalbkmr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="causal-estimands">Causal Estimands<a class="anchor" aria-label="anchor" href="#causal-estimands"></a>
</h2>
<p>We consider a setting in which <span class="math inline">\(n\)</span> subjects, labelled <span class="math inline">\(i = 1, ..., n\)</span>, enter a study at baseline (time <span class="math inline">\(t=0\)</span>) and are subjected to treatment <span class="math inline">\(A_{0, i}\)</span>. In a clinical trial, the value of <span class="math inline">\(A_{0, i}\)</span> is determined by the study protocol, usually at random. In an observational study, <span class="math inline">\(A_{0, i}\)</span> is observed and recorded. A collection of covariates, <span class="math inline">\(C_{0, i}\)</span>, are also measured at baseline. At the subsequent follow-up visits, the time-varying confounders, <span class="math inline">\(L_{t, i}\)</span> and treatment <span class="math inline">\(A_{t, i}\)</span> are recorded, <span class="math inline">\(t = 1, ..., T\)</span>. An outcome <span class="math inline">\(Y_i\)</span> is observed for each subject, measured at the final visit <span class="math inline">\(T\)</span>, <span class="math inline">\(Y_i\)</span> can be continuous or binary.</p>
<p>Along with the  <span class="math inline">\(Y_i\)</span> for each subject, for each possible realization of the treatment history <span class="math inline">\(\bar{a} \in \bar{\mathcal{A}}\)</span>; we also define <span class="math inline">\(Y_i^{\bar{a}}\)</span>, the  that would have been observed had the subject, possibly contrary to fact, received treatment history <span class="math inline">\(\bar{a}\)</span>.</p>
<p>In a simple setting with 3 visits, assume the following DAG. Under the static, fixed treatment regimes, the overall causal effect of the exposures changing form the <span class="math inline">\(25^{th}\)</span> percentile to the <span class="math inline">\(75^{th}\)</span> percentile can be defined as:</p>
<p><span class="math display">\[ACE = E[Y^{A_0 = a_0^*, A_1 = a_1^*, A_2 = a_2^*}] - E[Y^{A_0 = a_0, A_1 = a_1, A_2 = a_2}]\]</span> where <span class="math inline">\(a_0, a_1, a_2\)</span> are the <span class="math inline">\(25^{th}\)</span> percentile of the exposures, <span class="math inline">\(a_0^*, a_1^*, a_2^*\)</span> are the <span class="math inline">\(75^{th}\)</span> percentile of the exposures.</p>
<center>
<img src="gbkmrdag.png" width="240">
</center>
</div>
<div class="section level2">
<h2 id="g-formula">g-formula<a class="anchor" aria-label="anchor" href="#g-formula"></a>
</h2>
<p>The basic idea of g-formula is standardization, a common approach to estimating the expected value of <span class="math inline">\(Y^{\bar{a}}\)</span> in the population. (Naimai, Ashley I., et al., 2017) It can be illustrated in a simple time-fixed confounding example where there are only baseline confounders <span class="math inline">\(C_0\)</span> where the sum is over all possible values <span class="math inline">\(c_0\)</span> of <span class="math inline">\(C_0\)</span>. <span class="math display">\[E\left(Y^{\bar{a}}\right)=\sum_{C_{0}  } E\left(Y \mid \bar{A}=\bar{a}, C_{0}=c_{0}\right) P\left(C_{0}=c_{0}\right)\]</span> where the sum is over all possible values <span class="math inline">\(c_0\)</span> of <span class="math inline">\(C_0\)</span>.\</p>
<p>Using the above DAG, we now define 3 identifying assumptions:\</p>
<ol style="list-style-type: decimal">
<li><p>Consistency: <span class="math display">\[E[Y | A_0 = a_0, A_1 = a_1, A_2 = a_2] = E[Y^{a_0, a_1, a_2}| A_0 = a_0, A_1 = a_1, A_2 = a_2]\]</span></p></li>
<li><p>Exchangeability:<br></p></li>
<li><p>Positivity: <span class="math display">\[Pr(a_t|a_{t-1}, l_t, c_0) &gt; 0 \ \text{for all values of} \ l \  \text{with} \  Pr(L = l) \ne 0 \]</span></p></li>
</ol>
<p>The general expression of the g-formula for a static fixed intervention is: <span class="math display">\[\begin{equation}
E[Y^{\bar{a}}]= \sum_{\bar{l}} \mathrm{E}[Y \mid \bar{A}=\bar{a}, \bar{L}=\bar{l}, C_0 = c_0] \prod_{t=0}^{T} f\left(l_{t} \mid \bar{a}_{t-1}, \bar{l}_{t-1} \right)f(c_0) 
\end{equation}]
\]</span></p>
</div>
<div class="section level2">
<h2 id="bayesian-kernel-machine-regression">Bayesian kernel machine regression<a class="anchor" aria-label="anchor" href="#bayesian-kernel-machine-regression"></a>
</h2>
<p>We first review Kernel Machine Regression (KMR) as a framework for estimating the effect of a complex mixture when only a single time point of exposure is measured. For each subject <span class="math inline">\(i = 1, ..., n\)</span>, we assume</p>
<p><span class="math display">\[\begin{equation}
    Y_{i}=h\left(\mathbf{a}_{i}\right)+\mathbf{c}_{i}^{\mathrm{T}} \boldsymbol{\beta}+\epsilon_{i}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{a}_{i}=\left(a_{i 1}, \ldots, a_{i M}\right)^{\mathrm{T}}\)</span> is a vector of <span class="math inline">\(M\)</span> exposure variables.</p>
<p>It can be shown that the above model can be expressed as the mixed model <span class="math display">\[y_{i} \sim N\left(h_{i}+\mathbf{c}_{i}^{T} \boldsymbol{\beta}, \sigma^{2}\right)\]</span></p>
<p><span class="math display">\[\begin{equation}
\mathbf{h} \equiv\left(h_{1}, \ldots, h_{n}\right)^{\mathrm{T}} \sim N(\mathbf{0}, \tau \mathbf{K})    
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\mathbf{K}\)</span> is the kernel matrix, has <span class="math inline">\((i, j)-\)</span>element <span class="math inline">\(K(\mathbf{a}_{i}, \mathbf{a}_{j})\)</span></p>
<p>There are different choices of the kernel. We focus on the Gaussian kernel, which flexibly captures a wide range of underlying functional forms for <span class="math inline">\(h(\cdot)\)</span>, although the methods are applicable to a broad choice of kernels. We assume <span class="math display">\[\operatorname{cor}\left(h_{i}, h_{j}\right)=\exp \left\{-(1 / \rho) \sum_{m=1}^{M}\left(a_{i m}-a_{j m}\right)^{2}\right\}\]</span> where <span class="math inline">\(\rho\)</span> is a tuning parameter that regulates the smoothness of the dose-response function. This assumption implies that two subjects with similar exposures will have more similar risks (<span class="math inline">\(a_i\)</span> to <span class="math inline">\(a_j\)</span>, and <span class="math inline">\(h_i\)</span> will be close to <span class="math inline">\(h_j\)</span> ).</p>
<p><a href="https://academic.oup.com/biostatistics/article/16/3/493/269719" class="external-link">Bobb et al (2015)</a> presented the Bayesian Kernel Machine Regression (BKMR) as a framework to estimate the effect of a complex mixture on a health outcome.</p>
<p>To fit (2), we assume a at prior on the coefficients for the confounding variables, <span class="math inline">\(\beta \sim 1\)</span>, and<br><span class="math inline">\(\sigma^{-2} \sim \operatorname{Gamma}\left(a_{\sigma}, b_{\sigma}\right)\)</span>, where we set <span class="math inline">\(a_{\sigma} = b_{\sigma} = 0.001\)</span>.</p>
<p>We can parameterize BKMR by <span class="math inline">\(\lambda=\tau \sigma^{-2}\)</span>, and we assume a Gamma prior distribution for the variance component of <span class="math inline">\(\lambda\)</span>. For the smoothness parameter <span class="math inline">\(\rho\)</span>, we assume <span class="math inline">\(\rho \sim \operatorname{Unif}(a, b)\)</span> with <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=100\)</span>. For additional details regarding BKMR and prior specifications, see Bobb et al. (Bobb et al., <a href="https://academic.oup.com/biostatistics/article/16/3/493/269719" class="external-link">2015</a>, <a href="https://ehjournal.biomedcentral.com/articles/10.1186/s12940-018-0413-y" class="external-link">2018</a>)</p>
</div>
<div class="section level2">
<h2 id="g-bayesian-kernel-machine-regressiong-bkmr">g-Bayesian kernel machine regression(g-BKMR)<a class="anchor" aria-label="anchor" href="#g-bayesian-kernel-machine-regressiong-bkmr"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Anglen Bauer J, Devick KL, Bobb JF, Coull BA, Zoni S, Fedrighi C, Benedetti C, Guazzetti S, White R, Bellinger D, Yang Q, Webster T, Wright RO, Smith D, Lucchini R, Claus Henn. Associations from a mixture of manganese, lead, copper and chromium and adolescent neurobehavior.</p>
<p>Bobb JF, Claus Henn B, Valeri L, Coull BA. 2018. Statistical software for analyzing the health effects of multiple concurrent exposures via Bayesian kernel machine regression. Environ Health 17:67; <a href="doi:10.1186/s12940-018-0413-y" class="uri">doi:10.1186/s12940-018-0413-y</a>.</p>
<p>Bobb JF, Valeri L, Claus Henn B, Christiani DC, Wright RO, Mazumdar M, et al. 2015. Bayesian kernel machine regression for estimating the health effects of multi-pollutant mixtures. Biostatistics 16:493–508; <a href="doi:10.1093/biostatistics/kxu058" class="uri">doi:10.1093/biostatistics/kxu058</a>.</p>
<p>Rubin DB. 1987. Multiple imputation for nonresponse in surveys. Wiley.</p>
<p>Valeri L, Mazumdar M, Bobb J, Claus Henn B, Sharif O, Al. E. 2017. The joint effect of prenatal exposure to metal mixtures on neurodevelopmental outcomes at 24 months: evidence from rural Bangladesh. Env Heal Perspect 125; <a href="doi:DOI" class="uri">doi:DOI</a>: 10.1289/EHP614.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zilan Chai, Katrina Devick, <a href="https://www.lindavaleri.com/" class="external-link">Linda Valeri</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
